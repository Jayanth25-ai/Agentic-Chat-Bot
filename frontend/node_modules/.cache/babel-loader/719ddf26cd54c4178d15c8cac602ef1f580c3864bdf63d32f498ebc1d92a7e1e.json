{"ast":null,"code":"var _jsxFileName = \"D:\\\\CHAT-BOT\\\\frontend\\\\src\\\\pages\\\\Chat.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { api } from '../lib/auth';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Chat() {\n  _s();\n  var _pending$missing;\n  const [input, setInput] = useState('');\n  const [msgs, setMsgs] = useState([]); // { role: 'user'|'assistant', content }\n  const [pending, setPending] = useState(null); // { action, partialData, missing }\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  async function send(e) {\n    e === null || e === void 0 ? void 0 : e.preventDefault();\n    const text = input.trim();\n    if (!text) return;\n    const history = msgs.map(m => ({\n      role: m.role,\n      content: m.content\n    }));\n    setMsgs(prev => [...prev, {\n      role: 'user',\n      content: text\n    }]);\n    setInput('');\n    setLoading(true);\n    setError('');\n    try {\n      var _data$data, _data$data2, _data$data2$result;\n      const payload = {\n        message: text,\n        history\n      };\n      if (pending) payload.pending = pending;\n      const {\n        data\n      } = await api.post('/chat', payload);\n      const reply = (data === null || data === void 0 ? void 0 : (_data$data = data.data) === null || _data$data === void 0 ? void 0 : _data$data.replyText) || 'Okay.';\n      const need = data === null || data === void 0 ? void 0 : (_data$data2 = data.data) === null || _data$data2 === void 0 ? void 0 : (_data$data2$result = _data$data2.result) === null || _data$data2$result === void 0 ? void 0 : _data$data2$result.needMoreInfo;\n      if (need) {\n        var _data$data3, _data$data3$aiRespons;\n        setPending({\n          action: (pending === null || pending === void 0 ? void 0 : pending.action) || (data === null || data === void 0 ? void 0 : (_data$data3 = data.data) === null || _data$data3 === void 0 ? void 0 : (_data$data3$aiRespons = _data$data3.aiResponse) === null || _data$data3$aiRespons === void 0 ? void 0 : _data$data3$aiRespons.action) || 'create_todo',\n          partialData: need.partialData,\n          missing: need.missing\n        });\n      } else {\n        setPending(null);\n      }\n      setMsgs(prev => [...prev, {\n        role: 'assistant',\n        content: reply\n      }]);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      setError((err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || 'Failed to process message');\n    } finally {\n      setLoading(false);\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"grid\",\n    style: {\n      gap: '1rem'\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      style: {\n        maxWidth: 860,\n        margin: '0 auto',\n        width: '100%'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          maxHeight: '55vh',\n          overflowY: 'auto',\n          paddingBottom: '.5rem'\n        },\n        children: [msgs.map((m, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            justifyContent: m.role === 'user' ? 'flex-end' : 'flex-start',\n            margin: '.5rem 0'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"border\",\n            style: {\n              background: m.role === 'user' ? '#111827' : '#ffffff',\n              color: m.role === 'user' ? '#fff' : '#111827',\n              padding: '.5rem .75rem',\n              borderRadius: '.5rem',\n              maxWidth: '85%'\n            },\n            children: m.content\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 49,\n            columnNumber: 15\n          }, this)\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 48,\n          columnNumber: 13\n        }, this)), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            justifyContent: 'flex-start',\n            margin: '.5rem 0'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"border\",\n            style: {\n              background: '#ffffff',\n              color: '#6b7280',\n              padding: '.5rem .75rem',\n              borderRadius: '.5rem'\n            },\n            children: \"Assistant is typing\\u2026\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 56,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 55,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 46,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: send,\n        className: \"grid\",\n        style: {\n          gap: '.5rem'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          className: \"input\",\n          rows: 3,\n          placeholder: pending ? 'Answer the question (e.g., buy milk)' : 'Type your message',\n          value: input,\n          onChange: e => setInput(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 11\n        }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: 'crimson',\n            fontSize: '.875rem'\n          },\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn\",\n          disabled: loading,\n          children: loading ? 'Thinking...' : 'Send'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }, this), pending && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '.875rem',\n            color: '#6b7280'\n          },\n          children: [\"Waiting for: \", (_pending$missing = pending.missing) === null || _pending$missing === void 0 ? void 0 : _pending$missing.join(', '), \".\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 44,\n    columnNumber: 5\n  }, this);\n}\n_s(Chat, \"WqNZGvJvDfjJAW4q5/1VSd00eD8=\");\n_c = Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useState","api","jsxDEV","_jsxDEV","Chat","_s","_pending$missing","input","setInput","msgs","setMsgs","pending","setPending","loading","setLoading","error","setError","send","e","preventDefault","text","trim","history","map","m","role","content","prev","_data$data","_data$data2","_data$data2$result","payload","message","data","post","reply","replyText","need","result","needMoreInfo","_data$data3","_data$data3$aiRespons","action","aiResponse","partialData","missing","err","_err$response","_err$response$data","response","className","style","gap","children","maxWidth","margin","width","maxHeight","overflowY","paddingBottom","i","display","justifyContent","background","color","padding","borderRadius","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","rows","placeholder","value","onChange","target","fontSize","disabled","join","_c","$RefreshReg$"],"sources":["D:/CHAT-BOT/frontend/src/pages/Chat.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { api } from '../lib/auth';\n\nexport default function Chat() {\n  const [input, setInput] = useState('');\n  const [msgs, setMsgs] = useState([]); // { role: 'user'|'assistant', content }\n  const [pending, setPending] = useState(null); // { action, partialData, missing }\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  async function send(e) {\n    e?.preventDefault();\n    const text = input.trim();\n    if (!text) return;\n\n    const history = msgs.map(m => ({ role: m.role, content: m.content }));\n    setMsgs(prev => [...prev, { role: 'user', content: text }]);\n    setInput('');\n    setLoading(true);\n    setError('');\n\n    try {\n      const payload = { message: text, history };\n      if (pending) payload.pending = pending;\n      const { data } = await api.post('/chat', payload);\n      const reply = data?.data?.replyText || 'Okay.';\n\n      const need = data?.data?.result?.needMoreInfo;\n      if (need) {\n        setPending({ action: pending?.action || data?.data?.aiResponse?.action || 'create_todo', partialData: need.partialData, missing: need.missing });\n      } else {\n        setPending(null);\n      }\n\n      setMsgs(prev => [...prev, { role: 'assistant', content: reply }]);\n    } catch (err) {\n      setError(err?.response?.data?.message || 'Failed to process message');\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  return (\n    <div className=\"grid\" style={{ gap: '1rem' }}>\n      <div className=\"card\" style={{ maxWidth: 860, margin: '0 auto', width: '100%' }}>\n        <div style={{ maxHeight: '55vh', overflowY: 'auto', paddingBottom: '.5rem' }}>\n          {msgs.map((m, i) => (\n            <div key={i} style={{ display: 'flex', justifyContent: m.role === 'user' ? 'flex-end' : 'flex-start', margin: '.5rem 0' }}>\n              <div className=\"border\" style={{ background: m.role === 'user' ? '#111827' : '#ffffff', color: m.role === 'user' ? '#fff' : '#111827', padding: '.5rem .75rem', borderRadius: '.5rem', maxWidth: '85%' }}>\n                {m.content}\n              </div>\n            </div>\n          ))}\n          {loading && (\n            <div style={{ display: 'flex', justifyContent: 'flex-start', margin: '.5rem 0' }}>\n              <div className=\"border\" style={{ background: '#ffffff', color: '#6b7280', padding: '.5rem .75rem', borderRadius: '.5rem' }}>Assistant is typingâ€¦</div>\n            </div>\n          )}\n        </div>\n\n        <form onSubmit={send} className=\"grid\" style={{ gap: '.5rem' }}>\n          <textarea className=\"input\" rows={3} placeholder={pending ? 'Answer the question (e.g., buy milk)' : 'Type your message'} value={input} onChange={(e) => setInput(e.target.value)} />\n          {error && <div style={{ color: 'crimson', fontSize: '.875rem' }}>{error}</div>}\n          <button className=\"btn\" disabled={loading}>{loading ? 'Thinking...' : 'Send'}</button>\n          {pending && (\n            <div style={{ fontSize: '.875rem', color: '#6b7280' }}>Waiting for: {pending.missing?.join(', ')}.</div>\n          )}\n        </form>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}